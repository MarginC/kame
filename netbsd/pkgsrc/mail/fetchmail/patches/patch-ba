$NetBSD$

--- socket.c.orig	Mon Dec 20 05:02:24 1999
+++ socket.c	Wed Dec 22 17:52:09 1999
@@ -127,7 +127,6 @@
     void *request = NULL;
     int requestlen;
 #endif /* NET_SECURITY */
-    int i;
 
 #ifdef HAVE_SOCKETPAIR
     if (plugin)
@@ -154,7 +153,20 @@
 
  ret:
 #else /* NET_SECURITY */
+#if 0
     i = inner_connect(ai, NULL, 0, NULL, NULL, "fetchmail", NULL);
+#else
+    i = socket(ai->ai_family, ai->ai_socktype, 0);
+    if (i < 0) {
+	freeaddrinfo(ai);
+	return -1;
+    }
+    if (connect(i, (struct sockaddr *) ai->ai_addr, ai->ai_addrlen) < 0) {
+	freeaddrinfo(ai);
+	close(i);
+	return -1;
+    }
+#endif
 #endif /* NET_SECURITY */
 
     freeaddrinfo(ai);
