# YIPS @(#)$Id: racoon.conf,v 1.1 1999/08/08 23:31:25 itojun Exp $
# Refer to isakmp.h, isakmp_oakley.h and ipsec_doi.h
#
# 0x<val> : hex
# <val>   : decimal
# "<val>" : strings

#log 0x0fffffff;
log notify;

padding {
	max_length 20;      # x (long word)
	random_length off;
	check_length off;
	excl_lastone on;
}

# if no listen directive is specified, racoon will listen to all
# available interface addresses
listen {
	#isakmp 127.0.0.1 port 7000;
	#isakmp 203.178.141.215 port 8000;
	#isakmp 192.168.1.2 port 500;
	#isakmp 203.178.141.208 port 9001;
	#isakmp 202.249.11.124 port 9001;
	#admin 7002;
}

# main mode example, with "anonymous" (any peer) configuration
remote anonymous {
	try_to_send 3;   # count
	send_timer 20;   # (s)
	vendor_id "KAME/racoon";

	phase 1 {
		exchange_mode main;
		doi ipsec_doi;
		situation identity_only;

		#id_type FQDN hoge.hoge.hoge;
		proposal 1 isakmp {
			# P1 profile 1
			transform 1 oakley {
				encryption_algorithm des;
				hash_algorithm md5;
				authentication_method pre_shared_key "mekmitasdigoat";
				dh_group modp768;
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 2
			transform 2 oakley {
				encryption_algorithm des;
				hash_algorithm md5;
				authentication_method pre_shared_key "mekmitasdigoat";
				dh_group modp1024;
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 3
			transform 3 oakley {
				encryption_algorithm 3des;
				hash_algorithm md5;
				authentication_method pre_shared_key "mekmitasdigoat";
				dh_group modp768;
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 4
			transform 4 oakley {
				encryption_algorithm 3des;
				hash_algorithm md5;
				authentication_method pre_shared_key "mekmitasdigoat";
				dh_group modp1024;
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 5
			transform 5 oakley {
				encryption_algorithm des;
				hash_algorithm sha1;
				authentication_method pre_shared_key "mekmitasdigoat";
				dh_group modp768;
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 6
			transform 6 oakley {
				encryption_algorithm des;
				hash_algorithm sha1;
				authentication_method pre_shared_key "mekmitasdigoat";
				dh_group modp1024;
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 7
			transform 7 oakley {
				encryption_algorithm 3des;
				hash_algorithm sha1;
				authentication_method pre_shared_key "mekmitasdigoat";
				dh_group modp768;
				nonce_size 16;
				lifetime 300 second;
			}
			# P1 profile 8
			transform 8 oakley {
				encryption_algorithm 3des;
				hash_algorithm sha1;
				authentication_method pre_shared_key "mekmitasdigoat";
				dh_group modp1024;
				nonce_size 16;
				lifetime 300 second;
			}
			# P1 profile 9
			transform 9 oakley {
				encryption_algorithm blowfish 128;
				hash_algorithm sha1;
				authentication_method pre_shared_key "mekmitasdigoat";
				dh_group modp1024;
				nonce_size 16;
				lifetime 300 second;
			}
		}
	}

	phase 2 {
		doi ipsec_doi;
		situation identity_only;

		# profile 3n+1: no pfs_group
		# profile 3n+2: modp768
#		pfs_group modp768;
		# profile 3n+3: modp1024
#		pfs_group modp1024;

		id_type ipv4_address 0.0.0.1 port 500; # none or 500

		# P2 profile 1
		proposal 1 ah {
			transform 1 sha1 {
				authentication_algorithm hmac_sha1;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 4
		proposal 4 ah {
			transform 1 md5 {
				authentication_algorithm hmac_md5;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 7
		proposal 7 esp {
			transform 1 des {
				authentication_algorithm hmac_sha1;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 10
		proposal 10 esp {
			transform 1 3des {
				authentication_algorithm hmac_sha1;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 13
		proposal 13 esp {
			transform 1 des {
				authentication_algorithm hmac_md5;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 16
		proposal 16 esp {
			transform 1 3des {
				authentication_algorithm hmac_md5;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 19
		proposal 19 esp {
			transform 1 des {
				authentication_algorithm none;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 22
		proposal 22 esp {
			transform 1 3des {
				authentication_algorithm none;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 25
		proposal 25 esp {
			transform 1 null {
				authentication_algorithm hmac_sha1;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 28
		# may not work right
		proposal 28 esp {
			transform 1 null {
				authentication_algorithm hmac_md5;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 31 - not working right
#		proposal 31 esp {
#			transform 1 des {
#				authentication_algorithm none;
#				lifetime 300 second;
#				lifetime 10000 KB;
#			}
#		}
#		proposal 31 ah {
#			transform 1 sha1 {
#				authentication_algorithm hmac_sha1;
#				lifetime 300 second;
#				lifetime 10000 KB;
#			}
#		}
		# P2 profile 34 - not working right
#		proposal 34 esp {
#			transform 1 3des {
#				authentication_algorithm none;
#				lifetime 300 second;
#				lifetime 10000 KB;
#			}
#		}
#		proposal 34 ah {
#			transform 1 md5 {
#				authentication_algorithm hmac_md5;
#				lifetime 300 second;
#				lifetime 10000 KB;
#			}
#		}
	}

#	post-command {
#		path "/usr/local/v6/sbin";
#		exec "gifconfig gif0 inet 10.0.0.1 0.0.0.0";
#		success "ifconfig ed0";
#		failure "gifconfig gif0";
#	}
}

# aggressive mode example
remote 10.0.0.1 {
	try_to_send 3;   # count
	send_timer 20;   # (s)
	vendor_id "KAME/racoon";

	phase 1 {
		exchange_mode aggressive;
		doi ipsec_doi;
		situation identity_only;
		pfs_group modp1024;		# required

		#id_type FQDN hoge.hoge.hoge;
		proposal 1 isakmp {
			# P1 profile 1
			transform 1 oakley {
				encryption_algorithm des;
				hash_algorithm md5;
				authentication_method pre_shared_key "mekmitasdigoat";
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 2
			transform 2 oakley {
				encryption_algorithm des;
				hash_algorithm md5;
				authentication_method pre_shared_key "mekmitasdigoat";
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 3
			transform 3 oakley {
				encryption_algorithm 3des;
				hash_algorithm md5;
				authentication_method pre_shared_key "mekmitasdigoat";
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 4
			transform 4 oakley {
				encryption_algorithm 3des;
				hash_algorithm md5;
				authentication_method pre_shared_key "mekmitasdigoat";
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 5
			transform 5 oakley {
				encryption_algorithm des;
				hash_algorithm sha1;
				authentication_method pre_shared_key "mekmitasdigoat";
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 6
			transform 6 oakley {
				encryption_algorithm des;
				hash_algorithm sha1;
				authentication_method pre_shared_key "mekmitasdigoat";
				nonce_size 16;
				lifetime 900 second;
			}
			# P1 profile 7
			transform 7 oakley {
				encryption_algorithm 3des;
				hash_algorithm sha1;
				authentication_method pre_shared_key "mekmitasdigoat";
				nonce_size 16;
				lifetime 300 second;
			}
			# P1 profile 8
			transform 8 oakley {
				encryption_algorithm 3des;
				hash_algorithm sha1;
				authentication_method pre_shared_key "mekmitasdigoat";
				nonce_size 16;
				lifetime 300 second;
			}
		}
	}

	phase 2 {
		doi ipsec_doi;
		situation identity_only;

		# profile 3n+1: no pfs_group
		# profile 3n+2: modp768
#		pfs_group modp768;
		# profile 3n+3: modp1024
#		pfs_group modp1024;

		id_type ipv4_address 0.0.0.1 port 500; # none or 500

		# P2 profile 1
		proposal 1 ah {
			transform 1 sha1 {
				authentication_algorithm hmac_sha1;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 4
		proposal 4 ah {
			transform 1 md5 {
				authentication_algorithm hmac_md5;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 7
		proposal 7 esp {
			transform 1 des {
				authentication_algorithm hmac_sha1;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 10
		proposal 10 esp {
			transform 1 3des {
				authentication_algorithm hmac_sha1;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 13
		proposal 13 esp {
			transform 1 des {
				authentication_algorithm hmac_md5;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 16
		proposal 16 esp {
			transform 1 3des {
				authentication_algorithm hmac_md5;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 19
		proposal 19 esp {
			transform 1 des {
				authentication_algorithm none;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 22
		proposal 22 esp {
			transform 1 3des {
				authentication_algorithm none;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 25
		proposal 25 esp {
			transform 1 null {
				authentication_algorithm hmac_sha1;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 28
		# may not work right
		proposal 28 esp {
			transform 1 null {
				authentication_algorithm hmac_md5;
				lifetime 300 second;
				lifetime 10000 KB;
			}
		}
		# P2 profile 31 - not working right
#		proposal 31 esp {
#			transform 1 des {
#				authentication_algorithm none;
#				lifetime 300 second;
#				lifetime 10000 KB;
#			}
#		}
#		proposal 31 ah {
#			transform 1 sha1 {
#				authentication_algorithm hmac_sha1;
#				lifetime 300 second;
#				lifetime 10000 KB;
#			}
#		}
		# P2 profile 34 - not working right
#		proposal 34 esp {
#			transform 1 3des {
#				authentication_algorithm none;
#				lifetime 300 second;
#				lifetime 10000 KB;
#			}
#		}
#		proposal 34 ah {
#			transform 1 md5 {
#				authentication_algorithm hmac_md5;
#				lifetime 300 second;
#				lifetime 10000 KB;
#			}
#		}
	}

#	post-command {
#		path "/usr/local/v6/sbin";
#		exec "gifconfig gif0 inet 10.0.0.1 0.0.0.0";
#		success "ifconfig ed0";
#		failure "gifconfig gif0";
#	}
}

filter {
	default deny; # or allow
	allow {
		127.0.0.1;
		133.140.0.0/16;
	}
	deny {
		0.0.0.0;
	}
}
