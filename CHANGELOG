			CHANGELOG for KAME kit

$KAME: CHANGELOG,v 1.1483 2001/01/18 12:58:13 jinmei Exp $

<200101>
2001-01-18  JINMEI, Tatuya  <jinmei@isl.rdc.toshiba.co.jp>
	* bsdi4/contrib/bind/src/lib/irs/{lcl,nis}_ho.c: set ho_addrinfo
	function(s) properly. Without this fix, getaddrinfo() could cause
	SEGV when "local" or "nis" is specified to look hosts up. Be sure
	to update.

Thu Jan 18 02:00:32 JST 2001  itojun@iijlab.net
	* netbsd, openbsd, bsdi4: fix unsafe typecast in rtrequest1().
	  clarify 3rd arg handling in eonrtrequest().
	* netbsd, openbsd: integrate post-4.4BSD rtrequest1(), and argument
	  type change on ifa_rtrequest (3rd arg).

2001-01-16  JINMEI, Tatuya  <jinmei@isl.rdc.toshiba.co.jp>
	* kame/kame/dtcp/dtcps.rb (tunnelcleanup): deleted the pair of
	physical addresses by "gifconfig delete" after the session. This
	would prevent a garbage pair.

Tue Jan 16 00:43:19 JST 2001  itojun@iijab.net
	* sys/netinet6/mld6.c: emit MLD6 packet correctly (MTU setting was
	  wrong and the packet did not go out of the node).  the bug was
	  introduced around November 27, 2000.

Mon Jan 15 12:53:37 JST 2001  yu-inoue@jp.fujitsu.com
	* route6d:
	  when an interface goes down, do not advertise routes associated with
	  the interface, more like vendor routers.  by doing so, we can
	  avoid blackhole route (advertised even though the router lost
	  reachability), and we can switch to alternate route if one exists.
	  NOTE: it may cause reachability problem to the router itself, if
	  the router has interfaces without global addresses.

Sat Jan 13 12:45:56 JST 2001  itojun@iijlab.net
	* sys/netinet/ip_output.c: allow interface index to be specified with
	  multicast set/getsockopts, by using 0.0.0.0/8 (= pass it as network
	  endian value, 24bit in in_addr).  follows RFC1724 section 3.3.
	  suggested by Dave Thaler.

Fri Jan 12 18:54:52 JST 2001  itojun@iijlab.net
	* bsdi4: use BSD/OS 4.2 as the base version.

Thu Jan 11 02:47:37 JST 2001 sakane@ydc.co.jp
	* kame/sys/netkey/key.c:
	- key_acquire() does not require a secpolicy structure.
	  There was a possibility of kernel panic.
	  reported by <dwang@iPolicyNet.COM>.

Thu Jan 11 02:46:09 JST 2001 sakane@ydc.co.jp
	* racoon:
	- saved the type of SA in PF_KEY acquire message from the kernel
	  in order to reply a error.
	- removed from the scheduler immediately if error happened when sending
	  phase 1 initiation message.

Wed Jan 10 11:41:30 JST 2001 sakane@ydc.co.jp
	* racoon:
	- Fixed to configure the logging level.  racoon saves some parameters
	  before parsing configuration file in order to prefer the parameters
	  by command line.

Wed Jan 10 00:19:59 JST 2001  itojun@iijlab.net
	* sys/netinet6/icmp6.c: fix SEGV on icmp6 redirect input.
	  openbsd/netbsd only.  was introduced early Dec2000.

Tue Jan  9 16:50:07 JST 2001  itojun@iijlab.net
	* kame/libinet6/getaddrinfo.c: share getaddrinfo source code (again)
	  across all platforms we have.  though we have a jumbo #ifdef at the
	  bottom for DNS lookup portion, it is good to share the core logic.
	  while we are at it, simplify lots of things.
	  freebsd4 behavior change: $GAI support is dropped.  classful notation
	  (127.1) is dropped.

2001-01-07  JINMEI, Tatuya  <jinmei@isl.rdc.toshiba.co.jp>
	* kame/sys/netinet6/in6_pcb.c (in6_pcbnotify):
	* {bsdi4,freebsd[34],openbsd}/sys/netinet6/in6_pcb.c (in6_pcbbind):
	allowed an application to bind a socket to a deprecated address.
	For openbsd, a new check if the specified address is a node's own
	address was added as well.

2001-01-07  JINMEI, Tatuya  <jinmei@isl.rdc.toshiba.co.jp>
	* freebsd3/ports/libbind8: newly added based on BIND 8.2.2p7. This
	libbind supported A6 and DNAME.

2001-01-06  JINMEI, Tatuya  <jinmei@isl.rdc.toshiba.co.jp>
	* kame/kame/prefix/prefix.c: changed the default values of
	prefixes to infinity. Finite default values were bad, because they
	would be installed as the lifetimes of routers' addresses, which
	would never increment and be invalidated in the future.

	NOTE: if you use the kernel that has the change made on 2000-12-03
	by Koji Kawano (see CHANGELOG.2000) on a router box, and use the
	prefix command to assign addresses for the router, please be sure
	to update the prefix command and reboot the router (or at least
	reassign the addresses by the new prefix command). The lifetimes
	might now be decresing, and will expire in the near future.

	We'd even recommend you not to use the prefix command. It has
	recently caused many problematic situations, and almost no one
	understands the kernel prefix management routines well. You can do
	the same thing by the ordinally ifconfig command. See the latest
	rc.net6.sample file.

2001-01-06  JINMEI, Tatuya  <jinmei@isl.rdc.toshiba.co.jp>
	* kame/kame/etc/rc.net6: prohibit the prefix command by default.
	Since the command has recently caused many problems, we should
	reconsider the prefix management mechanism.

Fri Jan  5 22:51:16 JST 2001  itojun@iijlab.net
	* libinet6/name6.c: nuke getnodeby{name,addr}, which was mentioned
	  only in draft-ietf-ipngwg-bsd-api-new-01.txt.

Fri Jan  5 13:24:21 JST 2001  itojun@iijlab.net
	* getaddrinfo.c (shared/netbsd/openbsd/freebsd4)
	  query DNS only once per an AF.

2001-01-05  JINMEI, Tatuya  <jinmei@isl.rdc.toshiba.co.jp>
	* bsdi4/contrib/bind/src/lib/irs/gethostent.c: allowed gethostbyname
	to accept abbreviated IPv4 text addresses (like 127.1).
	(XXX: this change is against a bind8 policy, but just for backward
	compatibility.)

2001-01-02  JINMEI, Tatuya  <jinmei@isl.rdc.toshiba.co.jp>
	* freebsd3/lib/libinet6/Makefile: do not link resolver files when
	USE_LIBBIND6 is YES, so that enhanced libbind could be tested.
	* freebsd3/*/Makefile.inc: when USE_LIBBIND6 is YES, link libbind
	(as well as libinet6).

Tue Jan  2 17:15:44 JST 2001  itojun@iijlab.net
	* sys/netinet6/in6{,_ifattach}.c: correct use of IFAREF/IFFREE on
	  non-netbsd operating systems.  old code had memory leak possibility
	  on SIOCDIFADDR_IN6.  reported by hitachi guys.

2001-01-01  JINMEI, Tatuya  <jinmei@isl.rdc.toshiba.co.jp>
	* bsdi4/lib/libinet6:
	* bsdi4/contrib/bind/src/lib:
	massive improvements on DNS resolver including
	- IPv6 transport of DNS resolver. An IPv6 textual address can now
	  be in the /etc/resolv.conf file as a DNS server.
	- support of A6 and DNAME with bit string labels. They are still
	  very experimental, and thus disabled by default. "options a6"
	  and "options dname" in the /etc/resolv.conf file would enable A6
	  and DNAME, respectively.
	- EDNS0 OPT RR support with UDP buffer size negotiation. which is
	  disabled by default, and would enabled by "options edns0" in the
	  /etc/resolv.conf file.
	- clarification on the relationship between address family and irs
	  functions. For example, if you call getaddrinfo with AF_UNSPEC,
	  and irs.conf specifies to consider the local hosts file first,
	  then getaddrinfo would try to resolve an address in the
	  following order:
	  + IPv6 addresses in the hosts file.
	  + IPv4 addresses in the hosts file.
	  + IPv6 addresses via DNS.
	  + IPv4 addresses via DNS.
	  And, if one of the first two attempts succeeded, the remaining
	  two methods would be skipped. This change of the behavior would
	  be useful if you put both IPv6 and IPv4 addresses in the hosts
	  file, and do not want to see redundant DNS packets.
