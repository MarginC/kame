TODOs for KAME/OpenBSD
Jun-ichiro Hagino, KAME project
$Id: TODO,v 1.23 1999/10/07 18:08:14 itojun Exp $


Things we can do with the current code:
- ip6 layer
	ip6 output, ip6 input
	"goto ours" hack needs to be revisited
- icmp6 layer
	replies to ping, DAD
- raw6 socket input/output
- tcp6 socket input/output (both daemon and client)
- udp6 socket input/output (need more testing)
- "options IPSEC" compiles (enabled by default in sys/conf/files), but
  it means OpenBSD IPsec.  KAME IPsec is not available (and will never be 
  available as OpenBSD group will not be switching IPsec code).
  Because of this IPv6 IPsec is not available.
- hoplimit control advapi works fine.

Things we can't do with the current code:
- setsockopt(), ioctl and advapi needs checking
- check advanced APIs (both userland and kernel)
- multicast related items need checking
	I was told that OpenBSD guys will never replace IPsec code.
	Since we use same symbol (#ifdef IPSEC) to control ipsec code,
	we need to wrap KAME shared ipsec code by "#ifndef __OpenBSD__".
- enable KAME "goto ours" hack (check routing table code)
- ip6_output() does not consult /128 routes, and will not obey icmp6 redir.
- if you login via ssh, over IPv4 traffic to AF_INET6 socket (using IPv4
  mapped addres), login(1) or some other program *sometimes* dies with SEGV
  (string too long on wtmp?)
  workaround: run sshd -4, then sshd -6.  strangely enough no error will
  be raised with this configuration.
- if you are unlucky, current ipv6 pmtud code can cause kernel crash.
  (due to dangling pointer to clone rtentry from timeout queue)

Cleanup todo:
- move in6_select{src,hlim} out of kame/sys/netinet6/in6_pcb.c, put somewhere
  in kame/sys/netinet6/*.c, so that we can share the code among all the
  platforms (after kame/openbsd is stabilized enough)
- nuke unnecessary #ifdef NRL tcp/udp layer, for more readability
	(is it okay to do it?)
- security auditing :-)
